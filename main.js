!function(){"use strict";class e{constructor(e,t,s,r,i,n){this._cardData=e,this._id=e._id,this._name=e.name,this._link=e.link,this._owner=e.owner._id,this._cardId=e._id,this._likes=e.likes,this._cardSelector=t,this._handleCardClick=s,this._handleDeleteCardBinButton=r,this._onLikeButtonToggle=i,this._currentUser=n}_onCardUnlike=e=>{this._likes=e.likes,this._favIconElement.classList.remove("card__fav-icon-selected"),this._favCountElement.textContent=this._likes.length};_onCardLike=e=>{this._likes=e.likes,this._favIconElement.classList.toggle("card__fav-icon-selected"),this._favCountElement.textContent=this._likes.length};_handleFavIconClick=()=>{this._likes.find((e=>e._id===this._currentUser._userData._id))?this._onLikeButtonToggle(this._cardId,"Unlike",this._onCardUnlike):this._onLikeButtonToggle(this._cardId,"like",this._onCardLike)};_onCardClick=()=>{this._handleCardClick(this._cardData)};getCardElement(){return this._cardTemplate=document.querySelector(this._cardSelector),this._cardElement=this._cardTemplate.content.querySelector(".card").cloneNode(!0),this._deleteCardIcon=this._cardElement.querySelector(".card__del-button"),this._owner===this._currentUser._userData._id?this._deleteCardIcon.classList.remove("card__del-button-hidden"):this._deleteCardIcon.classList.add("card__del-button-hidden"),this._favIconElement=this._cardElement.querySelector(".card__fav-icon"),this._likes.find((e=>e._id===this._currentUser._userData._id))?this._favIconElement.classList.add("card__fav-icon-selected"):this._favIconElement.classList.add("card__fav-icon"),this._favCountElement=this._cardElement.querySelector(".card__fav_count"),this._favCountElement.textContent=this._likes.length,this._addNewCardTitle=this._cardElement.querySelector(".card__title"),this._cardImage=this._cardElement.querySelector(".card__image"),this._addNewCardTitle.textContent=this._name,this._cardImage.setAttribute("src",`${this._link}`),this._cardImage.setAttribute("alt",`Image of ${this._name}`),this._setEventListeners(),this._cardElement}_setEventListeners(){this._favIconElement.addEventListener("click",this._handleFavIconClick),this._cardImage.addEventListener("click",this._onCardClick),this._deleteCardIcon.addEventListener("click",(()=>{this._handleDeleteCardBinButton(this._cardId,this._cardElement)}))}}var t=class{constructor(e,t){this._form=t,this._inputElementSelector=e.inputElementSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonSelector=e.inactiveButtonSelector,this._inputErrorSelector=e.inputErrorSelector,this._errorSelectorHide=e.errorSelectorHide,this._errorSelector=e.errorSelector}_showInputError(e){const t=e.validationMessage;e.classList.add(this._inputErrorSelector);const s=this._form.querySelector(`#${e.id}+ .${this._errorSelector}`);s.textContent=t,s.classList.add(this._inputErrorSelector)}_hideInputError(e){e.classList.remove(this._inputErrorSelector);const t=this._form.querySelector(`#${e.id}+ .${this._errorSelector}`);t.classList.remove(this._inputErrorSelector),t.textContent=""}toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_enableButton(){this._buttonElement.classList.remove(this._inactiveButtonSelector),this._buttonElement.removeAttribute("disabled",!1)}disableButton(){this._buttonElement.classList.add(this._inactiveButtonSelector),this._buttonElement.setAttribute("disabled",!0)}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputElementSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this.toggleInputError(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e){let{popupModalSelector:t}=e;this._popupModal=document.querySelector(t),this.closeModal=this.closeModal.bind(this)}openModal(){this._popupModal.classList.add("modal_opened"),this._setEventListeners()}closeModal(){this._popupModal.classList.remove("modal_opened"),this._removeEventListeners()}_handleEscClose=e=>{"Escape"===e.key&&this.closeModal()};_closeModalByClick=e=>{(e.target===e.currentTarget||e.target.classList.contains("modal__close-button"))&&this.closeModal()};_removeEventListeners(){window.removeEventListener("keydown",this._handleEscClose),this._popupModal.removeEventListener("mousedown",this._closeModalByClick),this._popupModal.querySelector(".modal__close-button").removeEventListener("click",this.closeModal)}_setEventListeners(){window.addEventListener("keydown",this._handleEscClose),this._popupModal.addEventListener("mousedown",this._closeModalByClick),this._popupModal.querySelector(".modal__close-button").addEventListener("click",this.closeModal)}}class r extends s{constructor(e,t){super({popupModalSelector:e}),this._handleFormSubmit=t,this.handleSubmit=this.handleSubmit.bind(this),this._inputFields=this._popupModal.querySelectorAll(".modal__text-input")}_getInputValues(){const e=Array.from(this._popupModal.querySelectorAll(".modal__text-input")),t={};for(const s of e)t[s.name]=s.value;return t}setInputValues(e){this._inputFields.forEach((t=>{t.value=e[t.name]}))}closeModal(){super.closeModal(),this._popupModal.querySelector(".modal__form-content").reset()}handleSubmit(){this._handleFormSubmit(this._getInputValues())}_removeEventListeners(){super._removeEventListeners(),this._popupModal.removeEventListener("submit",this.handleSubmit)}_setEventListeners(){super._setEventListeners(),this._popupModal.addEventListener("submit",this.handleSubmit)}}class i{constructor(e){let{userData:t,selectors:s}=e;this._nameEl=s.name,this._linkEl=s.link,this._subtitleEl=s.subtitle,this._userData=t}setUserFields(){this._nameEl.textContent=this._userData.name,this._subtitleEl.textContent=this._userData.about,this._linkEl.setAttribute("src",this._userData.avatar)}getUserInfo(){return{name:this._userData.name,subtitle:this._userData.about,id:this._userData._id}}updateUserData(e){this._userData={...this._userData,...e}}}const n={inputElementSelector:".modal__text-input",submitButtonSelector:".modal__button",inactiveButtonSelector:"modal__button_disabled",inputErrorSelector:"modal__input-error_visible",errorSelectorHide:"modal__input-error-hide",errorSelector:"modal__input-error"},o=document.querySelector(n.submitButtonSelector),a=document.querySelector("#edit-profile"),l=document.querySelector("#add-new-card"),d=document.querySelector("#avatar-edit-modal"),c=document.querySelector("#create-button"),_=document.querySelector(".js-profile-edit-button"),u=document.querySelector(".profile__add-button"),h=document.querySelector(".cards__list"),m=document.querySelector(".profile__title"),p=document.querySelector(".profile__subtitle"),v=document.querySelector(".profile__image"),E=document.querySelector(".profile__avatar-edit-button"),b=document.querySelector("#avatar-save-button"),S=new r("#add-new-card",(function(e){c.textContent="Saving...",q.addNewCard(e).then((e=>{const t=B(e);w.prependItem(t),S.closeModal()})).catch((e=>{console.log(e)})).finally((()=>{c.textContent="Create"}))}),".modal__button"),f=new r("#edit-profile",(function(e){o.textContent="Saving...",q.editUserInfo(e).then((e=>{k.updateUserData(e),k.setUserFields(),f.closeModal()})).catch((e=>{console.log(e)})).finally((()=>{o.textContent="Save"}))}),".modal__button"),C=new r("#avatar-edit-modal",(function(e){b.textContent="Saving...",q.editAvatarLink(e).then((e=>{k.updateUserData(e),k.setUserFields(),C.closeModal()})).catch((e=>{console.error(e)})).finally((()=>{b.textContent="Save"}))}),".modal__button");let k;const L=new class extends s{constructor(e,t){super({popupModalSelector:e}),this.imageSelector=t}openModal(e){let{name:t,link:s}=e;const r=this._popupModal.querySelector(this.imageSelector),i=document.querySelector(".modal__image-caption");r.setAttribute("src",s),r.setAttribute("alt",t),i.textContent=t,super.openModal()}closeModal(){super.closeModal();const e=this._popupModal.querySelector(this.imageSelector);e.setAttribute("src",""),e.setAttribute("alt","")}}("#preview-image-modal",".modal-preview-image"),g=new class extends s{constructor(e,t,s){super({popupModalSelector:e}),this._handleFormSubmit=t,this._deleteConfirmButton=document.querySelector(s)}onYesClick=e=>{e.preventDefault(),this._handleFormSubmit(this.cardId,this.cardElement)};openModal(e,t){this.cardId=e,this.cardElement=t,super.openModal()}_removeEventListeners(){super._removeEventListeners(),this._deleteConfirmButton.removeEventListener("click",this.onYesClick)}_setEventListeners(){super._setEventListeners(),this._deleteConfirmButton.addEventListener("click",this.onYesClick)}}("#delete-image-confirm-modal",(function(e,t){q.deleteCard(e).then((()=>{t.remove(),g.closeModal()})).catch((e=>{console.log(e)}))}),"#delete-confirm-button"),y=new t(n,l),I=new t(n,a),M=new t(n,d),q=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards/`,{method:"GET",headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}editUserInfo(e){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.subtitle})})}addNewCard(e){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}likeACard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}unLikeACard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}editAvatarLink(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.link})})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"b685d3e0-616a-4dae-bc5b-53892a4f7953","Content-Type":"application/json"}}),w=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}appendItem(e){this._container.append(e)}renderItems(e){e.forEach((e=>{const t=this._renderer(e);this.appendItem(t)}))}prependItem(e){this._container.prepend(e)}}({items:q.getInitialCards,renderer:B},h);function B(t){return new e(t,"#card-template",D,A,U,k).getCardElement()}function U(e,t,s){"like"===t?q.likeACard(e).then((e=>{s(e)})).catch((e=>{console.error(e)})):q.unLikeACard(e).then(s).catch((e=>{console.error(e)}))}function D(e){L.openModal(e)}function A(e,t){g.openModal(e,t)}Promise.all([q.getUserInfo(),q.getInitialCards()]).then((e=>{let[t,s]=e;k=new i({userData:t,selectors:{name:m,subtitle:p,link:v}}),k.setUserFields(),w.renderItems(s)})).catch((e=>{console.error(e)})),_.addEventListener("click",(function(){I.disableButton();const e=k.getUserInfo();f.setInputValues(e),f.openModal()})),u.addEventListener("click",(function(){y.disableButton(),S.openModal()})),E.addEventListener("click",(function(){C.openModal(),M.disableButton()})),I.enableValidation(),y.enableValidation(),M.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFlBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUFDLEtBQUtDLFVBQVlQLEVBQ2pCTSxLQUFLRSxJQUFNUixFQUFTUSxJQUNwQkYsS0FBS0csTUFBUVQsRUFBU1UsS0FDdEJKLEtBQUtLLE1BQVFYLEVBQVNZLEtBQ3RCTixLQUFLTyxPQUFTYixFQUFTYyxNQUFNTixJQUM3QkYsS0FBS1MsUUFBVWYsRUFBU1EsSUFDeEJGLEtBQUtVLE9BQVNoQixFQUFTaUIsTUFDdkJYLEtBQUtZLGNBQWdCakIsRUFDckJLLEtBQUthLGlCQUFtQmpCLEVBQ3hCSSxLQUFLYywyQkFBNkJqQixFQUNsQ0csS0FBS2Usb0JBQXNCakIsRUFDM0JFLEtBQUtnQixhQUFlakIsQ0FDdEIsQ0FFQWtCLGNBQWlCQyxJQUNmbEIsS0FBS1UsT0FBU1EsRUFBS1AsTUFDbkJYLEtBQUttQixnQkFBZ0JDLFVBQVVDLE9BQU8sMkJBQ3RDckIsS0FBS3NCLGlCQUFpQkMsWUFBY3ZCLEtBQUtVLE9BQU9jLE1BQU0sRUFHeERDLFlBQWVQLElBQ2JsQixLQUFLVSxPQUFTUSxFQUFLUCxNQUNuQlgsS0FBS21CLGdCQUFnQkMsVUFBVU0sT0FBTywyQkFDdEMxQixLQUFLc0IsaUJBQWlCQyxZQUFjdkIsS0FBS1UsT0FBT2MsTUFBTSxFQUd4REcsb0JBQXNCQSxLQUVJM0IsS0FBS1UsT0FBT2tCLE1BQU1DLEdBQ2pDQSxFQUFLM0IsTUFBUUYsS0FBS2dCLGFBQWFjLFVBQVU1QixNQUloREYsS0FBS2Usb0JBQW9CZixLQUFLUyxRQUFTLFNBQVVULEtBQUtpQixlQUV0RGpCLEtBQUtlLG9CQUFvQmYsS0FBS1MsUUFBUyxPQUFRVCxLQUFLeUIsWUFDdEQsRUFHRk0sYUFBZUEsS0FDYi9CLEtBQUthLGlCQUFpQmIsS0FBS0MsVUFBVSxFQUd2QytCLGlCQThCRSxPQTdCQWhDLEtBQUtpQyxjQUFnQkMsU0FBU0MsY0FBY25DLEtBQUtZLGVBQ2pEWixLQUFLb0MsYUFBZXBDLEtBQUtpQyxjQUFjSSxRQUNwQ0YsY0FBYyxTQUNkRyxXQUFVLEdBQ2J0QyxLQUFLdUMsZ0JBQWtCdkMsS0FBS29DLGFBQWFELGNBQWMscUJBQ25EbkMsS0FBS08sU0FBV1AsS0FBS2dCLGFBQWFjLFVBQVU1QixJQUM5Q0YsS0FBS3VDLGdCQUFnQm5CLFVBQVVDLE9BQU8sMkJBRXRDckIsS0FBS3VDLGdCQUFnQm5CLFVBQVVvQixJQUFJLDJCQUVyQ3hDLEtBQUttQixnQkFBa0JuQixLQUFLb0MsYUFBYUQsY0FBYyxtQkFDckNuQyxLQUFLVSxPQUFPa0IsTUFBTUMsR0FDM0JBLEVBQUszQixNQUFRRixLQUFLZ0IsYUFBYWMsVUFBVTVCLE1BR2hERixLQUFLbUIsZ0JBQWdCQyxVQUFVb0IsSUFBSSwyQkFFbkN4QyxLQUFLbUIsZ0JBQWdCQyxVQUFVb0IsSUFBSSxrQkFFckN4QyxLQUFLc0IsaUJBQW1CdEIsS0FBS29DLGFBQWFELGNBQWMsb0JBQ3hEbkMsS0FBS3NCLGlCQUFpQkMsWUFBY3ZCLEtBQUtVLE9BQU9jLE9BQ2hEeEIsS0FBS3lDLGlCQUFtQnpDLEtBQUtvQyxhQUFhRCxjQUFjLGdCQUN4RG5DLEtBQUswQyxXQUFhMUMsS0FBS29DLGFBQWFELGNBQWMsZ0JBQ2xEbkMsS0FBS3lDLGlCQUFpQmxCLFlBQWN2QixLQUFLRyxNQUN6Q0gsS0FBSzBDLFdBQVdDLGFBQWEsTUFBUSxHQUFFM0MsS0FBS0ssU0FDNUNMLEtBQUswQyxXQUFXQyxhQUFhLE1BQVEsWUFBVzNDLEtBQUtHLFNBRXJESCxLQUFLNEMscUJBRUU1QyxLQUFLb0MsWUFDZCxDQUVBUSxxQkFDRTVDLEtBQUttQixnQkFBZ0IwQixpQkFBaUIsUUFBUzdDLEtBQUsyQixxQkFDcEQzQixLQUFLMEMsV0FBV0csaUJBQWlCLFFBQVM3QyxLQUFLK0IsY0FDL0MvQixLQUFLdUMsZ0JBQWdCTSxpQkFBaUIsU0FBUyxLQUM3QzdDLEtBQUtjLDJCQUEyQmQsS0FBS1MsUUFBU1QsS0FBS29DLGFBQWEsR0FFcEUsRUNGRixNQXpGQSxNQUNFM0MsWUFBWXFELEVBQVVDLEdBQ3BCL0MsS0FBS2dELE1BQVFELEVBQ2IvQyxLQUFLaUQsc0JBQXdCSCxFQUFTSSxxQkFDdENsRCxLQUFLbUQsc0JBQXdCTCxFQUFTTSxxQkFDdENwRCxLQUFLcUQsd0JBQTBCUCxFQUFTUSx1QkFDeEN0RCxLQUFLdUQsb0JBQXNCVCxFQUFTVSxtQkFDcEN4RCxLQUFLeUQsbUJBQXFCWCxFQUFTWSxrQkFDbkMxRCxLQUFLMkQsZUFBaUJiLEVBQVNjLGFBQ2pDLENBRUFDLGdCQUFnQkMsR0FDZCxNQUFNQyxFQUFlRCxFQUFhRSxrQkFDbENGLEVBQWExQyxVQUFVb0IsSUFBSXhDLEtBQUt1RCxxQkFDaEMsTUFBTVUsRUFBZWpFLEtBQUtnRCxNQUFNYixjQUM3QixJQUFHMkIsRUFBYUksUUFBUWxFLEtBQUsyRCxrQkFFaENNLEVBQWExQyxZQUFjd0MsRUFDM0JFLEVBQWE3QyxVQUFVb0IsSUFBSXhDLEtBQUt1RCxvQkFDbEMsQ0FFQVksZ0JBQWdCTCxHQUNkQSxFQUFhMUMsVUFBVUMsT0FBT3JCLEtBQUt1RCxxQkFDbkMsTUFBTVUsRUFBZWpFLEtBQUtnRCxNQUFNYixjQUM3QixJQUFHMkIsRUFBYUksUUFBUWxFLEtBQUsyRCxrQkFHaENNLEVBQWE3QyxVQUFVQyxPQUFPckIsS0FBS3VELHFCQUNuQ1UsRUFBYTFDLFlBQWMsRUFDN0IsQ0FFQTZDLGlCQUFpQk4sR0FDVkEsRUFBYU8sU0FBU0MsTUFHekJ0RSxLQUFLbUUsZ0JBQWdCTCxHQUZyQjlELEtBQUs2RCxnQkFBZ0JDLEVBSXpCLENBR0FTLG1CQUVFLE9BQU92RSxLQUFLd0UsV0FBV0MsTUFBTVgsSUFDbkJBLEVBQWFPLFNBQVNDLE9BRWxDLENBRUFJLGdCQUNFMUUsS0FBSzJFLGVBQWV2RCxVQUFVQyxPQUFPckIsS0FBS3FELHlCQUMxQ3JELEtBQUsyRSxlQUFlQyxnQkFBZ0IsWUFBWSxFQUNsRCxDQUVBQyxnQkFDRTdFLEtBQUsyRSxlQUFldkQsVUFBVW9CLElBQUl4QyxLQUFLcUQseUJBQ3ZDckQsS0FBSzJFLGVBQWVoQyxhQUFhLFlBQVksRUFDL0MsQ0FFQW1DLHFCQUNNOUUsS0FBS3VFLG1CQUNQdkUsS0FBSzZFLGdCQUVMN0UsS0FBSzBFLGVBRVQsQ0FFQTlCLHFCQUVFNUMsS0FBS3dFLFdBQWFPLE1BQU1DLEtBQ3RCaEYsS0FBS2dELE1BQU1pQyxpQkFBaUJqRixLQUFLaUQsd0JBR25DakQsS0FBSzJFLGVBQWlCM0UsS0FBS2dELE1BQU1iLGNBQWNuQyxLQUFLbUQsdUJBQ3BEbkQsS0FBS3dFLFdBQVdVLFNBQVNwQixJQUN2QkEsRUFBYWpCLGlCQUFpQixTQUFTLEtBQ3JDN0MsS0FBS29FLGlCQUFpQk4sR0FDdEI5RCxLQUFLOEUsb0JBQW9CLEdBQ3pCLEdBRU4sQ0FFQUssbUJBQ0VuRixLQUFLZ0QsTUFBTUgsaUJBQWlCLFVBQVd1QyxJQUVyQ0EsRUFBSUMsZ0JBQWdCLElBRXRCckYsS0FBSzRDLG9CQUNQLEdDdEZhLE1BQU0wQyxFQUNuQjdGLFlBQVc4RixHQUF5QixJQUF4QixtQkFBRUMsR0FBb0JELEVBQ2hDdkYsS0FBS3lGLFlBQWN2RCxTQUFTQyxjQUFjcUQsR0FDMUN4RixLQUFLMEYsV0FBYTFGLEtBQUswRixXQUFXQyxLQUFLM0YsS0FDekMsQ0FFQTRGLFlBQ0U1RixLQUFLeUYsWUFBWXJFLFVBQVVvQixJQUFJLGdCQUMvQnhDLEtBQUs0QyxvQkFDUCxDQUVBOEMsYUFDRTFGLEtBQUt5RixZQUFZckUsVUFBVUMsT0FBTyxnQkFDbENyQixLQUFLNkYsdUJBQ1AsQ0FFQUMsZ0JBQW1CVixJQUNELFdBQVpBLEVBQUlXLEtBQ04vRixLQUFLMEYsWUFDUCxFQUdGTSxtQkFBc0JaLEtBRWxCQSxFQUFJYSxTQUFXYixFQUFJYyxlQUNuQmQsRUFBSWEsT0FBTzdFLFVBQVUrRSxTQUFTLHlCQUU5Qm5HLEtBQUswRixZQUNQLEVBR0ZHLHdCQUNFTyxPQUFPQyxvQkFBb0IsVUFBV3JHLEtBQUs4RixpQkFDM0M5RixLQUFLeUYsWUFBWVksb0JBQW9CLFlBQWFyRyxLQUFLZ0csb0JBQ3ZEaEcsS0FBS3lGLFlBQ0Z0RCxjQUFjLHdCQUNka0Usb0JBQW9CLFFBQVNyRyxLQUFLMEYsV0FDdkMsQ0FFQTlDLHFCQUNFd0QsT0FBT3ZELGlCQUFpQixVQUFXN0MsS0FBSzhGLGlCQUN4QzlGLEtBQUt5RixZQUFZNUMsaUJBQWlCLFlBQWE3QyxLQUFLZ0csb0JBQ3BEaEcsS0FBS3lGLFlBQ0Z0RCxjQUFjLHdCQUNkVSxpQkFBaUIsUUFBUzdDLEtBQUswRixXQUNwQyxFQzVDYSxNQUFNWSxVQUFzQmhCLEVBQ3pDN0YsWUFBWStGLEVBQW9CZSxHQUM5QkMsTUFBTSxDQUFFaEIsdUJBQ1J4RixLQUFLeUcsa0JBQW9CRixFQUN6QnZHLEtBQUswRyxhQUFlMUcsS0FBSzBHLGFBQWFmLEtBQUszRixNQUMzQ0EsS0FBSzJHLGFBQWUzRyxLQUFLeUYsWUFBWVIsaUJBQWlCLHFCQUd4RCxDQUVBMkIsa0JBQ0UsTUFBTUMsRUFBYzlCLE1BQU1DLEtBQ3hCaEYsS0FBS3lGLFlBQVlSLGlCQUFpQix1QkFFOUI2QixFQUFTLENBQUMsRUFDaEIsSUFBSyxNQUFNQyxLQUFTRixFQUNsQkMsRUFBT0MsRUFBWSxNQUFLQSxFQUFhLE1BRXZDLE9BQU9ELENBQ1QsQ0FFQUUsZUFBZTlGLEdBQ2JsQixLQUFLMkcsYUFBYXpCLFNBQVMrQixJQUV6QkEsRUFBTUMsTUFBUWhHLEVBQUsrRixFQUFNN0csS0FBSyxHQUVsQyxDQUVBc0YsYUFDRWMsTUFBTWQsYUFDTjFGLEtBQUt5RixZQUFZdEQsY0FBYyx3QkFBd0JnRixPQUN6RCxDQUVBVCxlQUNFMUcsS0FBS3lHLGtCQUFrQnpHLEtBQUs0RyxrQkFDOUIsQ0FFQWYsd0JBQ0VXLE1BQU1YLHdCQUNON0YsS0FBS3lGLFlBQVlZLG9CQUFvQixTQUFVckcsS0FBSzBHLGFBQ3RELENBRUE5RCxxQkFDRTRELE1BQU01RCxxQkFDTjVDLEtBQUt5RixZQUFZNUMsaUJBQWlCLFNBQVU3QyxLQUFLMEcsYUFDbkQsRUM5Q2EsTUFBTVUsRUFDbkIzSCxZQUFXOEYsR0FBMEIsSUFBekIsU0FBRThCLEVBQVEsVUFBRUMsR0FBVy9CLEVBQ2pDdkYsS0FBS3VILFFBQVVELEVBQVVsSCxLQUN6QkosS0FBS3dILFFBQVVGLEVBQVVoSCxLQUN6Qk4sS0FBS3lILFlBQWNILEVBQVVJLFNBQzdCMUgsS0FBSzhCLFVBQVl1RixDQUNuQixDQUVBTSxnQkFDRTNILEtBQUt1SCxRQUFRaEcsWUFBY3ZCLEtBQUs4QixVQUFVMUIsS0FDMUNKLEtBQUt5SCxZQUFZbEcsWUFBY3ZCLEtBQUs4QixVQUFVOEYsTUFDOUM1SCxLQUFLd0gsUUFBUTdFLGFBQWEsTUFBTzNDLEtBQUs4QixVQUFVK0YsT0FDbEQsQ0FHQUMsY0FDRSxNQUFPLENBQ0wxSCxLQUFNSixLQUFLOEIsVUFBVTFCLEtBQ3JCc0gsU0FBVTFILEtBQUs4QixVQUFVOEYsTUFDekIxRCxHQUFJbEUsS0FBSzhCLFVBQVU1QixJQUV2QixDQUVBNkgsZUFBZVYsR0FDYnJILEtBQUs4QixVQUFZLElBQ1o5QixLQUFLOEIsYUFDTHVGLEVBRVAsRUM1QkssTUFBTXZFLEVBQVcsQ0FDdEJJLHFCQUFzQixxQkFDdEJFLHFCQUFzQixpQkFDdEJFLHVCQUF3Qix5QkFDeEJFLG1CQUFvQiw2QkFDcEJFLGtCQUFtQiwwQkFDbkJFLGNBQWUsc0JBR0pvRSxFQUFlOUYsU0FBU0MsY0FDbkNXLEVBQVNNLHNCQUdFNkUsRUFDWC9GLFNBQVNDLGNBQWMsaUJBQ1orRixFQUNYaEcsU0FBU0MsY0FBYyxpQkFDWmdHLEVBQ1hqRyxTQUFTQyxjQUFjLHNCQUNaaUcsRUFBZWxHLFNBQVNDLGNBQWMsa0JBR3RDa0csRUFBb0JuRyxTQUFTQyxjQUN4QywyQkFFV21HLEVBQW1CcEcsU0FBU0MsY0FBYyx3QkFDMUNvRyxFQUFZckcsU0FBU0MsY0FBYyxnQkFFbkNxRyxFQUFldEcsU0FBU0MsY0FBYyxtQkFDdENzRyxFQUFrQnZHLFNBQVNDLGNBQWMsc0JBQ3pDdUcsRUFBZ0J4RyxTQUFTQyxjQUFjLG1CQUV2Q3dHLEVBQW1CekcsU0FBU0MsY0FDdkMsZ0NBRVd5RyxFQUFtQjFHLFNBQVNDLGNBQWMsdUJDeEJqRDBHLEVBQWUsSUFBSXZDLEVBQ3ZCLGlCQTJJRixTQUFvQ3dDLEdBRWxDQyxFQUFBQSxZQUFvQyxZQUVwQ0MsRUFDR0MsV0FBV0gsR0FDWEksTUFBTWhJLElBQ0wsTUFBTWlJLEVBQU9DLEVBQVdsSSxHQUV4Qm1JLEVBQVFDLFlBQVlILEdBRXBCTixFQUFhbkQsWUFBWSxJQUUxQjZELE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksSUFFakJHLFNBQVEsS0FDUFosRUFBQUEsWUFBb0MsUUFBUSxHQUVsRCxHQTVKRSxrQkFFSWEsRUFBa0IsSUFBSXRELEVBQzFCLGlCQTRFRixTQUFpQ3dDLEdBQy9CQyxFQUFBQSxZQUFvQyxZQUNwQ0MsRUFDR2EsYUFBYWYsR0FDYkksTUFBTTdCLElBQ0x5QyxFQUFTL0IsZUFBZVYsR0FDeEJ5QyxFQUFTbkMsZ0JBQ1RpQyxFQUFnQmxFLFlBQVksSUFFN0I2RCxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLElBRWpCRyxTQUFRLEtBQ1BaLEVBQUFBLFlBQW9DLE1BQU0sR0FFaEQsR0F6RkUsa0JBR0lnQixFQUFrQixJQUFJekQsRUFDMUIsc0JBOEpGLFNBQWdDd0MsR0FDOUJDLEVBQUFBLFlBQXdDLFlBQ3hDQyxFQUNHZ0IsZUFBZWxCLEdBQ2ZJLE1BQU03QixJQUNMeUMsRUFBUy9CLGVBQWVWLEdBQ3hCeUMsRUFBU25DLGdCQUNUb0MsRUFBZ0JyRSxZQUFZLElBRTdCNkQsT0FBT0MsSUFDTkMsUUFBUVEsTUFBTVQsRUFBSSxJQUVuQkcsU0FBUSxLQUNQWixFQUFBQSxZQUF3QyxNQUFNLEdBRXBELEdBM0tFLGtCQUdGLElBQUllLEVBRUosTUFBTUksRUFBaUIsSUM3QnZCLGNBQTZCNUUsRUFDM0I3RixZQUFZK0YsRUFBb0IyRSxHQUM5QjNELE1BQU0sQ0FBRWhCLHVCQUNSeEYsS0FBS21LLGNBQWdCQSxDQUN2QixDQUVBdkUsVUFBU0wsR0FBaUIsSUFBaEIsS0FBRW5GLEVBQUksS0FBRUUsR0FBTWlGLEVBQ3RCLE1BQU02RSxFQUFVcEssS0FBS3lGLFlBQVl0RCxjQUFjbkMsS0FBS21LLGVBQzlDRSxFQUFVbkksU0FBU0MsY0FBYyx5QkFDdkNpSSxFQUFRekgsYUFBYSxNQUFPckMsR0FDNUI4SixFQUFRekgsYUFBYSxNQUFPdkMsR0FDNUJpSyxFQUFROUksWUFBY25CLEVBQ3RCb0csTUFBTVosV0FDUixDQUVBRixhQUNFYyxNQUFNZCxhQUNOLE1BQU0wRSxFQUFVcEssS0FBS3lGLFlBQVl0RCxjQUFjbkMsS0FBS21LLGVBQ3BEQyxFQUFRekgsYUFBYSxNQUFPLElBQzVCeUgsRUFBUXpILGFBQWEsTUFBTyxHQUM5QixHRFVBLHVCQUNBLHdCQUdJMkgsRUFBa0IsSUVsQ1QsY0FBNkJoRixFQUMxQzdGLFlBQ0UrRixFQUNBZSxFQUNBZ0UsR0FFQS9ELE1BQU0sQ0FBRWhCLHVCQUNSeEYsS0FBS3lHLGtCQUFvQkYsRUFDekJ2RyxLQUFLd0sscUJBQXVCdEksU0FBU0MsY0FDbkNvSSxFQUVKLENBRUFFLFdBQWNDLElBQ1pBLEVBQUdyRixpQkFDSHJGLEtBQUt5RyxrQkFBa0J6RyxLQUFLMkssT0FBUTNLLEtBQUs0SyxZQUFZLEVBR3ZEaEYsVUFBVStFLEVBQVFDLEdBQ2hCNUssS0FBSzJLLE9BQVNBLEVBQ2QzSyxLQUFLNEssWUFBY0EsRUFDbkJwRSxNQUFNWixXQUNSLENBQ0FDLHdCQUNFVyxNQUFNWCx3QkFDTjdGLEtBQUt3SyxxQkFBcUJuRSxvQkFBb0IsUUFBU3JHLEtBQUt5SyxXQUM5RCxDQUVBN0gscUJBQ0U0RCxNQUFNNUQscUJBQ041QyxLQUFLd0sscUJBQXFCM0gsaUJBQWlCLFFBQVM3QyxLQUFLeUssV0FDM0QsR0ZJQSwrQkFzS0YsU0FBb0NFLEVBQVFDLEdBQzFDNUIsRUFDRzZCLFdBQVdGLEdBQ1h6QixNQUFLLEtBQ0owQixFQUFZdkosU0FDWmlKLEVBQWdCNUUsWUFBWSxJQUU3QjZELE9BQU9DLElBRU5DLFFBQVFDLElBQUlGLEVBQUksR0FFdEIsR0EvS0UsMEJBSUlzQixFQUEwQixJQUFJQyxFQUNsQ2hDLEVBQ0FBLEdBRUlpQyxFQUEyQixJQUFJRCxFQUNuQ2hDLEVBQ0FBLEdBRUlrQyxFQUEwQixJQUFJRixFQUNsQ2hDLEVBQ0FBLEdBRUlDLEVBQU0sSUd0REcsTUFDYnZKLFlBQVl5TCxHQUVWbEwsS0FBS21MLFNBQVdELEVBQVFFLFFBQ3hCcEwsS0FBS3FMLFNBQVdILEVBQVFJLE9BQzFCLENBRUFDLGVBQWVDLEdBQ2IsT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxTQUN0QyxDQUVBQyxTQUFTQyxFQUFLYixHQUNaLE9BQU9jLE1BQU1ELEVBQUtiLEdBQVNoQyxLQUFLbEosS0FBS3VMLGVBQ3ZDLENBRUFVLGtCQUNFLE9BQU9qTSxLQUFLOEwsU0FBVSxHQUFFOUwsS0FBS21MLGtCQUFtQixDQUM5Q2UsT0FBUSxNQUNSWixRQUFTdEwsS0FBS3FMLFVBRWxCLENBRUF2RCxjQUNFLE9BQU85SCxLQUFLOEwsU0FBVSxHQUFFOUwsS0FBS21MLG9CQUFxQixDQUNoRGUsT0FBUSxNQUNSWixRQUFTdEwsS0FBS3FMLFVBRWxCLENBRUF4QixhQUFhc0MsR0FDWCxPQUFPbk0sS0FBSzhMLFNBQVUsR0FBRTlMLEtBQUttTCxvQkFBcUIsQ0FDaERlLE9BQVEsUUFDUlosUUFBU3RMLEtBQUtxTCxTQUVkZSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CbE0sS0FBTStMLEVBQU8vTCxLQUNid0gsTUFBT3VFLEVBQU96RSxZQUdwQixDQUVBdUIsV0FBV3NELEdBQ1QsT0FBT3ZNLEtBQUs4TCxTQUFVLEdBQUU5TCxLQUFLbUwsaUJBQWtCLENBQzdDZSxPQUFRLE9BQ1JaLFFBQVN0TCxLQUFLcUwsU0FFZGUsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQmxNLEtBQU1tTSxFQUFXbk0sS0FDakJFLEtBQU1pTSxFQUFXak0sUUFHdkIsQ0FFQXVLLFdBQVdGLEdBQ1QsT0FBTzNLLEtBQUs4TCxTQUFVLEdBQUU5TCxLQUFLbUwsa0JBQWtCUixJQUFVLENBQ3ZEdUIsT0FBUSxTQUNSWixRQUFTdEwsS0FBS3FMLFVBRWxCLENBRUFtQixVQUFVN0IsR0FDUixPQUFPM0ssS0FBSzhMLFNBQVUsR0FBRTlMLEtBQUttTCxrQkFBa0JSLFVBQWdCLENBQzdEdUIsT0FBUSxNQUNSWixRQUFTdEwsS0FBS3FMLFVBRWxCLENBRUFvQixZQUFZOUIsR0FDVixPQUFPM0ssS0FBSzhMLFNBQVUsR0FBRTlMLEtBQUttTCxrQkFBa0JSLFVBQWdCLENBQzdEdUIsT0FBUSxTQUNSWixRQUFTdEwsS0FBS3FMLFVBRWxCLENBRUFyQixlQUFlbEIsR0FDYixPQUFPOUksS0FBSzhMLFNBQVUsR0FBRTlMLEtBQUttTCwyQkFBNEIsQ0FDdkRlLE9BQVEsUUFDUlosUUFBU3RMLEtBQUtxTCxTQUNkZSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CekUsT0FBUWlCLEVBQVl4SSxRQUcxQixHSC9Ca0IsQ0FDbEI4SyxRQUFTLGlEQUNURSxRQUFTLENBQ1BvQixjQUFlLHVDQUNmLGVBQWdCLHNCQUdkckQsRUFBVSxJSTNERCxNQUNiNUosWUFBVzhGLEVBQXNCb0gsR0FBVyxJQUFoQyxNQUFFQyxFQUFLLFNBQUVDLEdBQVV0SCxFQUM3QnZGLEtBQUs4TSxPQUFTRixFQUNkNU0sS0FBSytNLFVBQVlGLEVBQ2pCN00sS0FBS2dOLFdBQWFMLENBQ3BCLENBR0FNLFdBQVdDLEdBQ1RsTixLQUFLZ04sV0FBV0csT0FBT0QsRUFDekIsQ0FHQUUsWUFBWVIsR0FDVkEsRUFBTTFILFNBQVN4RixJQUNiLE1BQU0yTixFQUFXck4sS0FBSytNLFVBQVVyTixHQUNoQ00sS0FBS2lOLFdBQVdJLEVBQVMsR0FFN0IsQ0FFQS9ELFlBQVk0RCxHQUNWbE4sS0FBS2dOLFdBQVdNLFFBQVFKLEVBQzFCLEdKc0NBLENBQUVOLE1BQU81RCxFQUFJaUQsZ0JBQWlCWSxTQUFVekQsR0FDeENMLEdBb0RGLFNBQVNLLEVBQVdtRSxHQWFsQixPQVhhLElBQUkvTixFQUNmK04sRUFDQSxpQkFDQUMsRUFDQTNOLEVBQ0FDLEVBQ0FnSyxHQUd1QjlILGdCQUczQixDQUVBLFNBQVNsQyxFQUFtQjZLLEVBQVFrQixFQUFRNEIsR0FDM0IsU0FBWDVCLEVBQ0Y3QyxFQUNHd0QsVUFBVTdCLEdBQ1Z6QixNQUFNaEksSUFDTHVNLEVBQVd2TSxFQUFLLElBRWpCcUksT0FBT0MsSUFDTkMsUUFBUVEsTUFBTVQsRUFBSSxJQUd0QlIsRUFDR3lELFlBQVk5QixHQUNaekIsS0FBS3VFLEdBQ0xsRSxPQUFPQyxJQUNOQyxRQUFRUSxNQUFNVCxFQUFJLEdBRzFCLENBdUJBLFNBQVNnRSxFQUFZckUsR0FDbkJlLEVBQWV0RSxVQUFVdUQsRUFDM0IsQ0F3QkEsU0FBU3RKLEVBQTBCcUUsRUFBSTBHLEdBQ3JDTixFQUFnQjFFLFVBQVUxQixFQUFJMEcsRUFDaEMsQ0F0SUFlLFFBQVErQixJQUFJLENBQUMxRSxFQUFJbEIsY0FBZWtCLEVBQUlpRCxvQkFFakMvQyxNQUFLM0QsSUFBdUIsSUFBckI4QixFQUFVc0csR0FBTXBJLEVBRXRCdUUsRUFBVyxJQUFJMUMsRUFBUyxDQUN0QkMsV0FDQUMsVUFBVyxDQUNUbEgsS0FBTTJJLEVBQ05yQixTQUFVcUIsRUFDVnpJLEtBQU15SSxLQUdWZSxFQUFTbkMsZ0JBQ1QwQixFQUFRK0QsWUFBWU8sRUFBTSxJQUUzQnBFLE9BQU9DLElBQ05DLFFBQVFRLE1BQU1ULEVBQUksSUFzSXRCVCxFQUFBQSxpQkFBNEMsU0FsSTVDLFdBQ0VpQyxFQUF5Qm5HLGdCQUN6QixNQUFNc0gsRUFBU3JDLEVBQVNoQyxjQUN4QjhCLEVBQWdCNUMsZUFBZW1GLEdBQy9CdkMsRUFBZ0JoRSxXQUNsQixJQThIQW1ELEVBQUFBLGlCQUEyQyxTQTNHM0MsV0FDRStCLEVBQXdCakcsZ0JBQ3hCZ0UsRUFBYWpELFdBQ2YsSUF5R0FtRCxFQUFBQSxpQkFBMkMsU0ExQzNDLFdBQ0VnQixFQUFnQm5FLFlBQ2hCcUYsRUFBd0JwRyxlQUMxQixJQTBDQW1HLEVBQXlCN0YsbUJBQ3pCMkYsRUFBd0IzRixtQkFDeEI4RixFQUF3QjlGLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRGVsZXRlQ2FyZEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGNhcmREYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2FyZEJpbkJ1dHRvbixcbiAgICBvbkxpa2VCdXR0b25Ub2dnbGUsXG4gICAgY3VycmVudFVzZXJcbiAgKSB7XG4gICAgdGhpcy5fY2FyZERhdGEgPSBjYXJkRGF0YTtcbiAgICB0aGlzLl9pZCA9IGNhcmREYXRhLl9pZDtcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9vd25lciA9IGNhcmREYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9jYXJkSWQgPSBjYXJkRGF0YS5faWQ7XG4gICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5saWtlcztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRCaW5CdXR0b24gPSBoYW5kbGVEZWxldGVDYXJkQmluQnV0dG9uO1xuICAgIHRoaXMuX29uTGlrZUJ1dHRvblRvZ2dsZSA9IG9uTGlrZUJ1dHRvblRvZ2dsZTtcbiAgICB0aGlzLl9jdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyO1xuICB9XG5cbiAgX29uQ2FyZFVubGlrZSA9IChkYXRhKSA9PiB7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2Zhdkljb25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19mYXYtaWNvbi1zZWxlY3RlZFwiKTtcbiAgICB0aGlzLl9mYXZDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gIH07XG5cbiAgX29uQ2FyZExpa2UgPSAoZGF0YSkgPT4ge1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9mYXZJY29uRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fZmF2LWljb24tc2VsZWN0ZWRcIik7XG4gICAgdGhpcy5fZmF2Q291bnRFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICB9O1xuXG4gIF9oYW5kbGVGYXZJY29uQ2xpY2sgPSAoKSA9PiB7XG4gICAgLy92YXJpYWJsZSB0byByZWdpc3RlciBpZiBjdXJyZW50IHVzZXIgbGlrZWQgdGhlIGltYWdlIG9yIG5vdFxuICAgIGNvbnN0IGN1cnJlbnRVc2VyTGlrZSA9IHRoaXMuX2xpa2VzLmZpbmQoKHVzZXIpID0+IHtcbiAgICAgIHJldHVybiB1c2VyLl9pZCA9PT0gdGhpcy5fY3VycmVudFVzZXIuX3VzZXJEYXRhLl9pZDtcbiAgICB9KTtcbiAgICBsZXQgZGlkQ3VycmVudFVzZXJMaWtlVGhpc0NhcmQgPSBjdXJyZW50VXNlckxpa2UgPyB0cnVlIDogZmFsc2U7XG4gICAgaWYgKGRpZEN1cnJlbnRVc2VyTGlrZVRoaXNDYXJkKSB7XG4gICAgICB0aGlzLl9vbkxpa2VCdXR0b25Ub2dnbGUodGhpcy5fY2FyZElkLCBcIlVubGlrZVwiLCB0aGlzLl9vbkNhcmRVbmxpa2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9vbkxpa2VCdXR0b25Ub2dnbGUodGhpcy5fY2FyZElkLCBcImxpa2VcIiwgdGhpcy5fb25DYXJkTGlrZSk7XG4gICAgfVxuICB9O1xuXG4gIF9vbkNhcmRDbGljayA9ICgpID0+IHtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fY2FyZERhdGEpO1xuICB9O1xuXG4gIGdldENhcmRFbGVtZW50KCkge1xuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHRoaXMuX2RlbGV0ZUNhcmRJY29uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWwtYnV0dG9uXCIpO1xuICAgIGlmICh0aGlzLl9vd25lciA9PT0gdGhpcy5fY3VycmVudFVzZXIuX3VzZXJEYXRhLl9pZCkge1xuICAgICAgdGhpcy5fZGVsZXRlQ2FyZEljb24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2RlbC1idXR0b24taGlkZGVuXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9kZWxldGVDYXJkSWNvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fZGVsLWJ1dHRvbi1oaWRkZW5cIik7XG4gICAgfVxuICAgIHRoaXMuX2Zhdkljb25FbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19mYXYtaWNvblwiKTtcbiAgICBjb25zdCB1c2VyTGlrZXMgPSB0aGlzLl9saWtlcy5maW5kKCh1c2VyKSA9PiB7XG4gICAgICByZXR1cm4gdXNlci5faWQgPT09IHRoaXMuX2N1cnJlbnRVc2VyLl91c2VyRGF0YS5faWQ7XG4gICAgfSk7XG4gICAgaWYgKHVzZXJMaWtlcykge1xuICAgICAgdGhpcy5fZmF2SWNvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImNhcmRfX2Zhdi1pY29uLXNlbGVjdGVkXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9mYXZJY29uRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fZmF2LWljb25cIik7XG4gICAgfVxuICAgIHRoaXMuX2ZhdkNvdW50RWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZmF2X2NvdW50XCIpO1xuICAgIHRoaXMuX2ZhdkNvdW50RWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9hZGROZXdDYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fYWRkTmV3Q2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIGAke3RoaXMuX2xpbmt9YCk7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBgSW1hZ2Ugb2YgJHt0aGlzLl9uYW1lfWApO1xuICAgIC8vY2FsbCBldmVudGxpc3RlbmVyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAvL3JldHVybiB0aGUgY2FyZCBlbGVtZW50IHRoYXQgaXMgY3JlYXRlZFxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mYXZJY29uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRmF2SWNvbkNsaWNrKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX29uQ2FyZENsaWNrKTtcbiAgICB0aGlzLl9kZWxldGVDYXJkSWNvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZEJpbkJ1dHRvbih0aGlzLl9jYXJkSWQsIHRoaXMuX2NhcmRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0RWxlbWVudFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRFcnJvclNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRFcnJvclNlbGVjdG9yO1xuICAgIHRoaXMuX2Vycm9yU2VsZWN0b3JIaWRlID0gc2V0dGluZ3MuZXJyb3JTZWxlY3RvckhpZGU7XG4gICAgdGhpcy5fZXJyb3JTZWxlY3RvciA9IHNldHRpbmdzLmVycm9yU2VsZWN0b3I7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JTZWxlY3Rvcik7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0rIC4ke3RoaXMuX2Vycm9yU2VsZWN0b3J9YFxuICAgICk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JTZWxlY3Rvcik7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvclNlbGVjdG9yKTtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfSsgLiR7dGhpcy5fZXJyb3JTZWxlY3Rvcn1gXG4gICAgKTtcbiAgICAvLyBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvclNlbGVjdG9ySGlkZSk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvclNlbGVjdG9yKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICAvLyBUaGUgZnVuY3Rpb24gdGFrZXMgYW4gYXJyYXkgb2YgZm9ybSBpbnB1dCBmaWVsZHNcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAvLyBpdGVyYXRlIG92ZXIgdGhlIGFycmF5IHVzaW5nIHRoZSBzb21lKCkgbWV0aG9kXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBGaW5kIGFsbCB0aGUgZm9ybSBmaWVsZHMgYW5kIG1ha2UgYW4gYXJyYXkgb2YgdGhlbVxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRFbGVtZW50U2VsZWN0b3IpXG4gICAgKTtcbiAgICAvLyBGaW5kIHRoZSBzdWJtaXQgYnV0dG9uIGluIHRoZSBjdXJyZW50IGZvcm1cbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy50b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIC8vIENhbmNlbCBkZWZhdWx0IGJlaGF2aW9yIGZvciBmb3JtXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBNb2RhbFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cE1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuY2xvc2VNb2RhbCA9IHRoaXMuY2xvc2VNb2RhbC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3Blbk1vZGFsKCkge1xuICAgIHRoaXMuX3BvcHVwTW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2VNb2RhbCgpIHtcbiAgICB0aGlzLl9wb3B1cE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XG4gICAgfVxuICB9O1xuXG4gIF9jbG9zZU1vZGFsQnlDbGljayA9IChldnQpID0+IHtcbiAgICBpZiAoXG4gICAgICBldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCB8fFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnV0dG9uXCIpXG4gICAgKSB7XG4gICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICB9XG4gIH07XG5cbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fcG9wdXBNb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2Nsb3NlTW9kYWxCeUNsaWNrKTtcbiAgICB0aGlzLl9wb3B1cE1vZGFsXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpXG4gICAgICAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2VNb2RhbCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cE1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fY2xvc2VNb2RhbEJ5Q2xpY2spO1xuICAgIHRoaXMuX3BvcHVwTW9kYWxcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZU1vZGFsKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cE1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwTW9kYWxTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IHRoaXMuaGFuZGxlU3VibWl0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5faW5wdXRGaWVsZHMgPSB0aGlzLl9wb3B1cE1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX3RleHQtaW5wdXRcIik7XG4gICAgLy8gdGhpcy5fc3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdWJtaXRCdG4pO1xuICAgIC8vIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRGaWVsZHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fcG9wdXBNb2RhbC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX190ZXh0LWlucHV0XCIpXG4gICAgKTtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGlucHV0RmllbGRzKSB7XG4gICAgICByZXN1bHRbZmllbGRbXCJuYW1lXCJdXSA9IGZpZWxkW1widmFsdWVcIl07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRGaWVsZHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIC8vIGhlcmUgeW91IGluc2VydCB0aGUgYHZhbHVlYCBieSB0aGUgYG5hbWVgIG9mIHRoZSBpbnB1dFxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2VNb2RhbCgpIHtcbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XG4gICAgdGhpcy5fcG9wdXBNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtLWNvbnRlbnRcIikucmVzZXQoKTtcbiAgfVxuXG4gIGhhbmRsZVN1Ym1pdCgpIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICB9XG5cbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwTW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLmhhbmRsZVN1Ym1pdCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBNb2RhbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuaGFuZGxlU3VibWl0KTtcbiAgfVxuXG4gIC8vIC8vIGFkZCAyIHBhcmFtczogaXNMb2FkaW5nIGFuZCBsb2FkaW5nVGV4dCB3aXRoIGEgZGVmYXVsdCB0ZXh0XG4gIC8vIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nID0gdHJ1ZSwgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gIC8vICAgaWYgKGlzTG9hZGluZykge1xuICAvLyAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gIC8vICAgfSBlbHNlIHtcbiAgLy8gICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XG4gIC8vICAgfVxuICAvLyB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgdXNlckRhdGEsIHNlbGVjdG9ycyB9KSB7XG4gICAgdGhpcy5fbmFtZUVsID0gc2VsZWN0b3JzLm5hbWU7XG4gICAgdGhpcy5fbGlua0VsID0gc2VsZWN0b3JzLmxpbms7XG4gICAgdGhpcy5fc3VidGl0bGVFbCA9IHNlbGVjdG9ycy5zdWJ0aXRsZTtcbiAgICB0aGlzLl91c2VyRGF0YSA9IHVzZXJEYXRhO1xuICB9XG5cbiAgc2V0VXNlckZpZWxkcygpIHtcbiAgICB0aGlzLl9uYW1lRWwudGV4dENvbnRlbnQgPSB0aGlzLl91c2VyRGF0YS5uYW1lO1xuICAgIHRoaXMuX3N1YnRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl91c2VyRGF0YS5hYm91dDtcbiAgICB0aGlzLl9saW5rRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX3VzZXJEYXRhLmF2YXRhcik7XG4gIH1cblxuICAvL21ldGhvZCB0byBkaXNwYWx5IHVzZXIgIG5hbWUgYW5kIHRpdGxlIHdoZW4gZm9ybSBvcGVucyB1cFxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fdXNlckRhdGEubmFtZSxcbiAgICAgIHN1YnRpdGxlOiB0aGlzLl91c2VyRGF0YS5hYm91dCxcbiAgICAgIGlkOiB0aGlzLl91c2VyRGF0YS5faWQsXG4gICAgfTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJEYXRhKHVzZXJEYXRhKSB7XG4gICAgdGhpcy5fdXNlckRhdGEgPSB7XG4gICAgICAuLi50aGlzLl91c2VyRGF0YSxcbiAgICAgIC4uLnVzZXJEYXRhLFxuICAgIH07XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgaW5wdXRFbGVtZW50U2VsZWN0b3I6IFwiLm1vZGFsX190ZXh0LWlucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uU2VsZWN0b3I6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yU2VsZWN0b3I6IFwibW9kYWxfX2lucHV0LWVycm9yX3Zpc2libGVcIixcbiAgZXJyb3JTZWxlY3RvckhpZGU6IFwibW9kYWxfX2lucHV0LWVycm9yLWhpZGVcIixcbiAgZXJyb3JTZWxlY3RvcjogXCJtb2RhbF9faW5wdXQtZXJyb3JcIixcbn07XG5cbmV4cG9ydCBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuKTtcblxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlTW9kYWxGb3JtRWxlbWVudCA9XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlXCIpO1xuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRNb2RhbEZvcm1FbGVtZW50ID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtbmV3LWNhcmRcIik7XG5leHBvcnQgY29uc3QgZWRpdEF2YXRhck1vZGFsRm9ybUVsZW1lbnQgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1lZGl0LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IGNyZWF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY3JlYXRlLWJ1dHRvblwiKTtcblxuLypEZWNsYXJlIEVsZW1lbnRzICovXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5qcy1wcm9maWxlLWVkaXQtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuLy9FeHRyYWN0IHRpdGxlIGFuZCBzdWJ0aXRsZSBlbGVtZW50c1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVN1YnRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19zdWJ0aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbi8vRXh0cmFjdCBpbnB1dCBmaWVsZHMgZnJvbSBlZGl0IHByb2ZpbGUgbW9kYWxcbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgYXZhdGFyU2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLXNhdmUtYnV0dG9uXCIpO1xuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBEZWxldGVDYXJkRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9EZWxldGVDYXJkRm9ybS5qc1wiO1xuaW1wb3J0ICogYXMgY29uc3RhbnQgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjYWRkLW5ldy1jYXJkXCIsXG4gIGhhbmRsZUFkZE5ld0NhcmRGb3JtU3VibWl0LFxuICBcIi5tb2RhbF9fYnV0dG9uXCJcbik7XG5jb25zdCBhZGRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjZWRpdC1wcm9maWxlXCIsXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0LFxuICBcIi5tb2RhbF9fYnV0dG9uXCJcbik7XG5cbmNvbnN0IGF2YXRhckVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhdmF0YXItZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVBdmF0YXJTYXZlQnV0dG9uLFxuICBcIi5tb2RhbF9fYnV0dG9uXCJcbik7XG5cbmxldCB1c2VySW5mbztcblxuY29uc3QgY2FyZEltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXG4gIFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIixcbiAgXCIubW9kYWwtcHJldmlldy1pbWFnZVwiXG4pO1xuXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgRGVsZXRlQ2FyZEZvcm0oXG4gIFwiI2RlbGV0ZS1pbWFnZS1jb25maXJtLW1vZGFsXCIsXG4gIGhhbmRsZURlbGV0ZUNhcmRGb3JtU3VibWl0LFxuICBcIiNkZWxldGUtY29uZmlybS1idXR0b25cIlxuKTtcblxuLy9pbnN0YW50aWF0ZSBGb3JtVmFsaWRhdG9yIGNsYXNzXG5jb25zdCBhZGROZXdDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBjb25zdGFudC5zZXR0aW5ncyxcbiAgY29uc3RhbnQuYWRkTmV3Q2FyZE1vZGFsRm9ybUVsZW1lbnRcbik7XG5jb25zdCBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgY29uc3RhbnQuc2V0dGluZ3MsXG4gIGNvbnN0YW50LmVkaXRQcm9maWxlTW9kYWxGb3JtRWxlbWVudFxuKTtcbmNvbnN0IGVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGNvbnN0YW50LnNldHRpbmdzLFxuICBjb25zdGFudC5lZGl0QXZhdGFyTW9kYWxGb3JtRWxlbWVudFxuKTtcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiYjY4NWQzZTAtNjE2YS00ZGFlLWJjNWItNTM4OTJhNGY3OTUzXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgeyBpdGVtczogYXBpLmdldEluaXRpYWxDYXJkcywgcmVuZGVyZXI6IGNyZWF0ZUNhcmQgfSxcbiAgY29uc3RhbnQuY2FyZHNMaXN0XG4pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC8vIGRlc3RydWN0dXJlIHRoZSByZXNwb25zZVxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcbiAgICAvLyBzZXQgYWxsIHRoZSBkYXRhXG4gICAgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICAgICAgdXNlckRhdGEsXG4gICAgICBzZWxlY3RvcnM6IHtcbiAgICAgICAgbmFtZTogY29uc3RhbnQucHJvZmlsZVRpdGxlLFxuICAgICAgICBzdWJ0aXRsZTogY29uc3RhbnQucHJvZmlsZVN1YnRpdGxlLFxuICAgICAgICBsaW5rOiBjb25zdGFudC5wcm9maWxlQXZhdGFyLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICB1c2VySW5mby5zZXRVc2VyRmllbGRzKCk7XG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIC8vIGNhdGNoIHBvc3NpYmxlIGVycm9yc1xuICB9KTtcblxuZnVuY3Rpb24gaGFuZGxlT3BlbkVkaXRQcm9maWxlRm9ybSgpIHtcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgY29uc3QgdmFsdWVzID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgYWRkUHJvZmlsZVBvcHVwLnNldElucHV0VmFsdWVzKHZhbHVlcyk7XG4gIGFkZFByb2ZpbGVQb3B1cC5vcGVuTW9kYWwoKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgY29uc3RhbnQuc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgYXBpXG4gICAgLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnVwZGF0ZVVzZXJEYXRhKHVzZXJEYXRhKTtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJGaWVsZHMoKTtcbiAgICAgIGFkZFByb2ZpbGVQb3B1cC5jbG9zZU1vZGFsKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNvbnN0YW50LnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGROZXdDYXJkQnV0dG9uKCkge1xuICBhZGROZXdDYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIG5ld0NhcmRQb3B1cC5vcGVuTW9kYWwoKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XG4gIC8vIGNyZWF0ZSBpbnN0YW5jZSBvZiBDYXJkIGNsYXNzXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBpdGVtLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBvbkNhcmRDbGljayxcbiAgICBoYW5kbGVEZWxldGVDYXJkQmluQnV0dG9uLFxuICAgIG9uTGlrZUJ1dHRvblRvZ2dsZSxcbiAgICB1c2VySW5mb1xuICApO1xuICAvL2NyZWF0ZSBhIGNhcmQgYnkgY2FsbGluZyBnZXRDYXJkRWxlbWVudCBtZXRob2QgZnJvbSBDYXJkIGNsYXNzXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZXRDYXJkRWxlbWVudCgpO1xuICAvL3JldHVybiB0aGUgY2FyZFxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIG9uTGlrZUJ1dHRvblRvZ2dsZShjYXJkSWQsIHN0YXR1cywgY2FsbGJhY2tGbikge1xuICBpZiAoc3RhdHVzID09PSBcImxpa2VcIikge1xuICAgIGFwaVxuICAgICAgLmxpa2VBQ2FyZChjYXJkSWQpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjYWxsYmFja0ZuKGRhdGEpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGFwaVxuICAgICAgLnVuTGlrZUFDYXJkKGNhcmRJZClcbiAgICAgIC50aGVuKGNhbGxiYWNrRm4pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGROZXdDYXJkRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICAvL3NldCBidXR0b24gdG8gU2F2aW5nLi4gd2hpbGUgYXBpIGNhbGwgaXMgbWFkZVxuICBjb25zdGFudC5jcmVhdGVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAvL2NyZWF0ZSBhIG5ldyBjYXJkIHdpdGggaW5wdXQgdmFsdWVzIGZyb20gc2VydmVyXG4gIGFwaVxuICAgIC5hZGROZXdDYXJkKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcbiAgICAgIC8vQXR0YWNoIG5ldyBjYXJkIHRvIGJlZ2luaW5nIG9mIGNvbnRhaW5lclxuICAgICAgc2VjdGlvbi5wcmVwZW5kSXRlbShjYXJkKTtcbiAgICAgIC8vY2xvc2UgcG9wdXAgYWZ0ZXIgc3VibWl0XG4gICAgICBuZXdDYXJkUG9wdXAuY2xvc2VNb2RhbCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBjb25zdGFudC5jcmVhdGVCdXR0b24udGV4dENvbnRlbnQgPSBcIkNyZWF0ZVwiO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBvbkNhcmRDbGljayhjYXJkKSB7XG4gIGNhcmRJbWFnZVBvcHVwLm9wZW5Nb2RhbChjYXJkKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRWRpdEJ1dHRvbigpIHtcbiAgYXZhdGFyRWRpdFBvcHVwLm9wZW5Nb2RhbCgpO1xuICBlZGl0QXZhdGFyRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclNhdmVCdXR0b24oaW5wdXRWYWx1ZXMpIHtcbiAgY29uc3RhbnQuYXZhdGFyU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gIGFwaVxuICAgIC5lZGl0QXZhdGFyTGluayhpbnB1dFZhbHVlcylcbiAgICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnVwZGF0ZVVzZXJEYXRhKHVzZXJEYXRhKTtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJGaWVsZHMoKTtcbiAgICAgIGF2YXRhckVkaXRQb3B1cC5jbG9zZU1vZGFsKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgY29uc3RhbnQuYXZhdGFyU2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkQmluQnV0dG9uKGlkLCBjYXJkRWxlbWVudCkge1xuICBkZWxldGVDYXJkUG9wdXAub3Blbk1vZGFsKGlkLCBjYXJkRWxlbWVudCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmRGb3JtU3VibWl0KGNhcmRJZCwgY2FyZEVsZW1lbnQpIHtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlTW9kYWwoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAvLyBzaG93IGVycm9yXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xufVxuXG4vKiBFdmVudCBMaXN0ZW5lcnMgKi9cbmNvbnN0YW50LmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVPcGVuRWRpdFByb2ZpbGVGb3JtKTtcbmNvbnN0YW50LmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUFkZE5ld0NhcmRCdXR0b24pO1xuY29uc3RhbnQuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQXZhdGFyRWRpdEJ1dHRvbik7XG5cbi8vc3RhcnQgZm9ybSB2YWxpZGF0aW9uc1xuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZE5ld0NhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmVkaXRBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwTW9kYWxTZWxlY3RvciwgaW1hZ2VTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBNb2RhbFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuaW1hZ2VTZWxlY3RvciA9IGltYWdlU2VsZWN0b3I7XG4gIH1cblxuICBvcGVuTW9kYWwoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICBjb25zdCBpbWFnZUVsID0gdGhpcy5fcG9wdXBNb2RhbC5xdWVyeVNlbGVjdG9yKHRoaXMuaW1hZ2VTZWxlY3Rvcik7XG4gICAgY29uc3QgY2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLWNhcHRpb25cIik7XG4gICAgaW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbGluayk7XG4gICAgaW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgbmFtZSk7XG4gICAgY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3Blbk1vZGFsKCk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHN1cGVyLmNsb3NlTW9kYWwoKTtcbiAgICBjb25zdCBpbWFnZUVsID0gdGhpcy5fcG9wdXBNb2RhbC5xdWVyeVNlbGVjdG9yKHRoaXMuaW1hZ2VTZWxlY3Rvcik7XG4gICAgaW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJcIik7XG4gICAgaW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgXCJcIik7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERlbGV0ZUNhcmRGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwb3B1cE1vZGFsU2VsZWN0b3IsXG4gICAgaGFuZGxlRm9ybVN1Ym1pdCxcbiAgICBkZWxldGVDb25maXJtQnV0dG9uU2VsZWN0b3JcbiAgKSB7XG4gICAgc3VwZXIoeyBwb3B1cE1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZGVsZXRlQ29uZmlybUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBkZWxldGVDb25maXJtQnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgb25ZZXNDbGljayA9IChldikgPT4ge1xuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLmNhcmRJZCwgdGhpcy5jYXJkRWxlbWVudCk7XG4gIH07XG5cbiAgb3Blbk1vZGFsKGNhcmRJZCwgY2FyZEVsZW1lbnQpIHtcbiAgICB0aGlzLmNhcmRJZCA9IGNhcmRJZDtcbiAgICB0aGlzLmNhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQ7XG4gICAgc3VwZXIub3Blbk1vZGFsKCk7XG4gIH1cbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2RlbGV0ZUNvbmZpcm1CdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMub25ZZXNDbGljayk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZGVsZXRlQ29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5vblllc0NsaWNrKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9gLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHZhbHVlcykge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHZhbHVlcy5uYW1lLFxuICAgICAgICBhYm91dDogdmFsdWVzLnN1YnRpdGxlLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBhZGROZXdDYXJkKGNhcmRWYWx1ZXMpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGNhcmRWYWx1ZXMubmFtZSxcbiAgICAgICAgbGluazogY2FyZFZhbHVlcy5saW5rLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBsaWtlQUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIHVuTGlrZUFDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBlZGl0QXZhdGFyTGluayhpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBpbnB1dFZhbHVlcy5saW5rLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7XG4gIH1cblxuICAvL3Rha2VzIGEgRE9NIGVsZW1lbnQgYW5kIGFkZCBpdCB0byBjb250YWluZXJcbiAgYXBwZW5kSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIC8vcmVuZGVyIGFsbCBjYXJkIGVsZW1lbnRzXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoY2FyZERhdGEpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRJdGVtID0gdGhpcy5fcmVuZGVyZXIoY2FyZERhdGEpO1xuICAgICAgdGhpcy5hcHBlbmRJdGVtKGNhcmRJdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByZXBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZEJpbkJ1dHRvbiIsIm9uTGlrZUJ1dHRvblRvZ2dsZSIsImN1cnJlbnRVc2VyIiwidGhpcyIsIl9jYXJkRGF0YSIsIl9pZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9vd25lciIsIm93bmVyIiwiX2NhcmRJZCIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZEJpbkJ1dHRvbiIsIl9vbkxpa2VCdXR0b25Ub2dnbGUiLCJfY3VycmVudFVzZXIiLCJfb25DYXJkVW5saWtlIiwiZGF0YSIsIl9mYXZJY29uRWxlbWVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsIl9mYXZDb3VudEVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsIl9vbkNhcmRMaWtlIiwidG9nZ2xlIiwiX2hhbmRsZUZhdkljb25DbGljayIsImZpbmQiLCJ1c2VyIiwiX3VzZXJEYXRhIiwiX29uQ2FyZENsaWNrIiwiZ2V0Q2FyZEVsZW1lbnQiLCJfY2FyZFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2NhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9kZWxldGVDYXJkSWNvbiIsImFkZCIsIl9hZGROZXdDYXJkVGl0bGUiLCJfY2FyZEltYWdlIiwic2V0QXR0cmlidXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfZm9ybSIsIl9pbnB1dEVsZW1lbnRTZWxlY3RvciIsImlucHV0RWxlbWVudFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uU2VsZWN0b3IiLCJfaW5wdXRFcnJvclNlbGVjdG9yIiwiaW5wdXRFcnJvclNlbGVjdG9yIiwiX2Vycm9yU2VsZWN0b3JIaWRlIiwiZXJyb3JTZWxlY3RvckhpZGUiLCJfZXJyb3JTZWxlY3RvciIsImVycm9yU2VsZWN0b3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiX2hpZGVJbnB1dEVycm9yIiwidG9nZ2xlSW5wdXRFcnJvciIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0TGlzdCIsInNvbWUiLCJfZW5hYmxlQnV0dG9uIiwiX2J1dHRvbkVsZW1lbnQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJkaXNhYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsIl9yZWYiLCJwb3B1cE1vZGFsU2VsZWN0b3IiLCJfcG9wdXBNb2RhbCIsImNsb3NlTW9kYWwiLCJiaW5kIiwib3Blbk1vZGFsIiwiX3JlbW92ZUV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZUVzY0Nsb3NlIiwia2V5IiwiX2Nsb3NlTW9kYWxCeUNsaWNrIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNvbnRhaW5zIiwid2luZG93IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsImhhbmRsZVN1Ym1pdCIsIl9pbnB1dEZpZWxkcyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0RmllbGRzIiwicmVzdWx0IiwiZmllbGQiLCJzZXRJbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsIlVzZXJJbmZvIiwidXNlckRhdGEiLCJzZWxlY3RvcnMiLCJfbmFtZUVsIiwiX2xpbmtFbCIsIl9zdWJ0aXRsZUVsIiwic3VidGl0bGUiLCJzZXRVc2VyRmllbGRzIiwiYWJvdXQiLCJhdmF0YXIiLCJnZXRVc2VySW5mbyIsInVwZGF0ZVVzZXJEYXRhIiwic3VibWl0QnV0dG9uIiwiZWRpdFByb2ZpbGVNb2RhbEZvcm1FbGVtZW50IiwiYWRkTmV3Q2FyZE1vZGFsRm9ybUVsZW1lbnQiLCJlZGl0QXZhdGFyTW9kYWxGb3JtRWxlbWVudCIsImNyZWF0ZUJ1dHRvbiIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsImNhcmRzTGlzdCIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVTdWJ0aXRsZSIsInByb2ZpbGVBdmF0YXIiLCJhdmF0YXJFZGl0QnV0dG9uIiwiYXZhdGFyU2F2ZUJ1dHRvbiIsIm5ld0NhcmRQb3B1cCIsImlucHV0VmFsdWVzIiwiY29uc3RhbnQiLCJhcGkiLCJhZGROZXdDYXJkIiwidGhlbiIsImNhcmQiLCJjcmVhdGVDYXJkIiwic2VjdGlvbiIsInByZXBlbmRJdGVtIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImFkZFByb2ZpbGVQb3B1cCIsImVkaXRVc2VySW5mbyIsInVzZXJJbmZvIiwiYXZhdGFyRWRpdFBvcHVwIiwiZWRpdEF2YXRhckxpbmsiLCJlcnJvciIsImNhcmRJbWFnZVBvcHVwIiwiaW1hZ2VTZWxlY3RvciIsImltYWdlRWwiLCJjYXB0aW9uIiwiZGVsZXRlQ2FyZFBvcHVwIiwiZGVsZXRlQ29uZmlybUJ1dHRvblNlbGVjdG9yIiwiX2RlbGV0ZUNvbmZpcm1CdXR0b24iLCJvblllc0NsaWNrIiwiZXYiLCJjYXJkSWQiLCJjYXJkRWxlbWVudCIsImRlbGV0ZUNhcmQiLCJhZGROZXdDYXJkRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJlZGl0QXZhdGFyRm9ybVZhbGlkYXRvciIsIm9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsImZldGNoIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwidmFsdWVzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYXJkVmFsdWVzIiwibGlrZUFDYXJkIiwidW5MaWtlQUNhcmQiLCJhdXRob3JpemF0aW9uIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhcHBlbmRJdGVtIiwiZWxlbWVudCIsImFwcGVuZCIsInJlbmRlckl0ZW1zIiwiY2FyZEl0ZW0iLCJwcmVwZW5kIiwiaXRlbSIsIm9uQ2FyZENsaWNrIiwiY2FsbGJhY2tGbiIsImFsbCIsImNhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==